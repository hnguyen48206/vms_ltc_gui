{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/HoangN/Desktop/NW/LTC_GUI/base_ltc_clarity/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { querySelectorRoots as e } from \"../utils/dom.js\";\nimport { onFirstInteraction as t, onChildListMutation as r } from \"../utils/events.js\";\nimport { createId as a } from \"../utils/identity.js\";\nimport { KeyNavigationListController as s } from \"./key-navigation-list.controller.js\";\nlet i = null;\nfunction d(e) {\n  return t => t.addInitializer(t => new n(t, e));\n}\nclass n {\n  constructor(e, t) {\n    this.host = e, this.id = \"__\" + a(), this.host.addController(this), this.config = {\n      layout: \"both\",\n      item: \"\",\n      dropZone: \"\",\n      manageFocus: !0,\n      manageTabindex: !1,\n      ...t\n    };\n  }\n  get items() {\n    return e(this.host, this.config.item + '[draggable=\"true\"]');\n  }\n  get dropZones() {\n    return e(this.host, this.config.dropZone + '[draggable=\"false\"]');\n  }\n  hostConnected() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      yield _this.host.updateComplete, t(_this.host).then(() => {\n        var _this$host$shadowRoot, _this$host$shadowRoot2;\n        _this.addDragEventListeners(_this.items), _this.initializeKeyListController(), _this.host.addEventListener(\"click\", /*#__PURE__*/function () {\n          var _ref = _asyncToGenerator(function* (e) {\n            return _this.clickItem(e);\n          });\n          return function (_x) {\n            return _ref.apply(this, arguments);\n          };\n        }()), _this.host.addEventListener(\"cdsKeyChange\", e => _this.focusItem(e)), (_this$host$shadowRoot = _this.host.shadowRoot) !== null && _this$host$shadowRoot !== void 0 && _this$host$shadowRoot.addEventListener(\"click\", /*#__PURE__*/function () {\n          var _ref2 = _asyncToGenerator(function* (e) {\n            return _this.clickItem(e);\n          });\n          return function (_x2) {\n            return _ref2.apply(this, arguments);\n          };\n        }()), (_this$host$shadowRoot2 = _this.host.shadowRoot) !== null && _this$host$shadowRoot2 !== void 0 && _this$host$shadowRoot2.addEventListener(\"cdsKeyChange\", e => _this.focusItem(e)), _this.observer = r(_this.host, e => {\n          if (e) {\n            const t = Array.from(e.addedNodes).filter(e => e.draggable);\n            t.length && _this.addDragEventListeners(t);\n          }\n        });\n      });\n    })();\n  }\n  hostDisconnected() {\n    var _this$observer;\n    (_this$observer = this.observer) === null || _this$observer === void 0 || _this$observer.disconnect();\n  }\n  initializeKeyListController() {\n    Object.defineProperty(this.host, this.id, {\n      get: () => this.items.map(e => e.querySelector(\"[cds-draggable]\"))\n    }), new s(this.host, {\n      layout: this.config.layout,\n      keyListItems: this.id,\n      manageFocus: this.config.manageFocus,\n      manageTabindex: this.config.manageTabindex\n    });\n  }\n  clickItem(e) {\n    const t = Array.from(e.composedPath()).find(e => e.getAttribute && \"handle\" === e.getAttribute(\"cds-draggable\")),\n      r = e.composedPath()[0].closest(\"[draggable]\");\n    t && r && (\"true\" === t.ariaPressed ? (r.setAttribute(\"cds-draggable\", \"active\"), o(e.currentTarget, r, null, \"grabbed\", \"touch\")) : \"false\" === t.ariaPressed && (r.removeAttribute(\"cds-draggable\"), o(e.currentTarget, r, null, \"dropped\", \"touch\")));\n  }\n  focusItem(e) {\n    var _e$detail$previousIte;\n    if (e.detail.keyListItems === this.id && \"active\" === ((_e$detail$previousIte = e.detail.previousItem) === null || _e$detail$previousIte === void 0 ? void 0 : _e$detail$previousIte.closest(\"[draggable]\").getAttribute(\"cds-draggable\"))) {\n      var _e$detail$previousIte2;\n      const t = (_e$detail$previousIte2 = e.detail.previousItem) === null || _e$detail$previousIte2 === void 0 ? void 0 : _e$detail$previousIte2.closest(\"[draggable]\"),\n        r = e.detail.activeItem.closest(\"[draggable]\");\n      \"handle\" === e.detail.activeItem.getAttribute(\"cds-draggable\") && t !== r && (e.detail.previousItem.ariaPressed = \"false\", e.detail.activeItem.ariaPressed = \"true\", e.detail.previousItem.pressed = !1, e.detail.activeItem.pressed = !0, t.removeAttribute(\"cds-draggable\"), r.setAttribute(\"cds-draggable\", \"active\"), o(e.detail.activeItem, t, r, \"reordered\", \"key\"));\n    }\n  }\n  addDragEventListeners(e) {\n    e.filter(e => !e.cdsDraggableItem).forEach(e => {\n      return (t = e).cdsDraggableItem = \"item\", t.addEventListener(\"dragstart\", g, !1), t.addEventListener(\"dragover\", c, !1), t.addEventListener(\"drop\", l, !1), t.addEventListener(\"dragleave\", u, !1), void t.addEventListener(\"dragend\", e => e.currentTarget.removeAttribute(\"cds-draggable\"), !1);\n      var t;\n    }), this.dropZones.filter(e => !e.cdsDraggableItem).forEach(e => {\n      e.addEventListener(\"dragover\", c, !1), e.addEventListener(\"dragleave\", u, !1), e.addEventListener(\"drop\", l, !1), e.cdsDraggableItem = \"dropzone\";\n    });\n  }\n}\nfunction o(_x3, _x4, _x5, _x6, _x7) {\n  return _o.apply(this, arguments);\n}\nfunction _o() {\n  _o = _asyncToGenerator(function* (e, t, r, a, s) {\n    e !== null && e !== void 0 && e.updateComplete && (yield e.updateComplete), e.dispatchEvent(new CustomEvent(\"cdsDraggableChange\", {\n      detail: {\n        from: t,\n        target: r,\n        type: a,\n        interaction: s\n      },\n      bubbles: !0\n    }));\n  });\n  return _o.apply(this, arguments);\n}\nfunction g(e) {\n  i = e.currentTarget, e.dataTransfer.effectAllowed = \"move\", e.dataTransfer.setDragImage(e.currentTarget, 0, 0), e.currentTarget.setAttribute(\"cds-draggable\", \"active\"), o(e.currentTarget, e.currentTarget, null, \"grabbed\", \"touch\");\n}\nfunction c(e) {\n  return e.preventDefault && e.preventDefault(), e.dataTransfer.dropEffect = \"move\", i !== e.currentTarget && e.currentTarget.setAttribute(\"cds-draggable\", \"target\"), !1;\n}\nfunction l(e) {\n  const t = i,\n    r = e.currentTarget;\n  return t !== null && t !== void 0 && t.removeAttribute(\"cds-draggable\"), r !== null && r !== void 0 && r.removeAttribute(\"cds-draggable\"), o(e.currentTarget, t, r, \"reordered\", \"touch\"), !1;\n}\nfunction u(e) {\n  \"target\" === e.currentTarget.getAttribute(\"cds-draggable\") && e.currentTarget.removeAttribute(\"cds-draggable\");\n}\nexport { n as DraggableListController, d as draggableList };\n//# sourceMappingURL=draggable-list.controller.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}