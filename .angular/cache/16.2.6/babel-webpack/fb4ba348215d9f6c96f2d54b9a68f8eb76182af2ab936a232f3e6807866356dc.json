{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/HoangN/Desktop/NW/LTC_GUI/base_ltc_clarity/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { isSafari as o, isWindows as i } from \"../utils/browser.js\";\nimport { onChildListMutation as t } from \"../utils/events.js\";\nimport { getFlattenedFocusableItems as r } from \"../utils/traversal.js\";\nfunction e(o = {\n  update: \"slot\"\n}) {\n  return i => {\n    i.addInitializer(i => {\n      i.ariaGridController || (i.ariaGridController = new s(i, o));\n    });\n  };\n}\nclass s {\n  constructor(o, i = {\n    update: \"slot\"\n  }) {\n    this.host = o, this.config = i, this.observers = [], o.addController(this);\n  }\n  hostConnected() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      yield _this.host.updateComplete, _this.intializeColumnSort(), _this.update(), \"slot\" === _this.config.update ? _this.host.shadowRoot.addEventListener(\"slotchange\", () => _this.host.updateComplete.then(() => _this.update())) : _this.observers.push(t(_this.host, () => _this.host.updateComplete.then(() => _this.update())));\n    })();\n  }\n  hostDisconnected() {\n    this.observers.forEach(o => o === null || o === void 0 ? void 0 : o.disconnect());\n  }\n  update() {\n    this.grid = {\n      grid: this.host.grid ? this.host.grid : this.host,\n      columnRowGroup: this.host.columnRowGroup,\n      columnRow: this.host.columnRow,\n      columns: this.host.columns,\n      rowGroup: this.host.rowGroup,\n      rows: this.host.rows,\n      cells: this.host.cells,\n      footerRowGroup: this.host.footerRowGroup,\n      footerRow: this.host.footerRow,\n      footerCells: this.host.footerCells,\n      placeholderCell: this.host.placeholderCell\n    }, this.initializeGrid(), this.intializeColumns(), this.initializeRows(), this.initializeCells(), this.initializePlaceholder(), this.intializeFooter();\n  }\n  intializeColumnSort() {\n    this.host.addEventListener(\"sortChange\", o => {\n      const i = o.composedPath().find(o => \"columnheader\" === o.role);\n      i && (i.ariaSort = o.detail);\n    });\n  }\n  initializeGrid() {\n    var _this$grid$rows;\n    const o = Math.max((_this$grid$rows = this.grid.rows) === null || _this$grid$rows === void 0 ? void 0 : _this$grid$rows.length, 1),\n      i = this.grid.footerRow ? 1 : 0;\n    this.grid.grid.role = \"grid\", this.grid.grid.ariaRowCount = \"\" + (1 + o + i), this.grid.grid.ariaColCount = \"\" + this.grid.columns.length;\n  }\n  intializeColumns() {\n    this.grid.columnRowGroup.role = \"rowgroup\", this.grid.columnRow.role = \"row\", this.grid.columnRow.ariaRowIndex = \"1\", this.grid.columns.forEach((o, i) => {\n      o.role = \"columnheader\", o.ariaColIndex = \"\" + (i + 1), o.ariaSort = \"none\", this.patchInvalidScreenReaderBehavior(o);\n    });\n  }\n  initializeRows() {\n    var _this$grid$rows2;\n    (_this$grid$rows2 = this.grid.rows) === null || _this$grid$rows2 === void 0 || _this$grid$rows2.forEach((o, i) => {\n      o.role = \"row\", o.ariaRowIndex = \"\" + (i + 2);\n    });\n  }\n  initializeCells() {\n    var _this$grid$cells;\n    const o = this.grid.columns.length;\n    (_this$grid$cells = this.grid.cells) === null || _this$grid$cells === void 0 || _this$grid$cells.forEach((i, t) => {\n      i.role || (i.role = \"gridcell\"), i.ariaColIndex = \"\" + (t % o + 1);\n    });\n  }\n  initializePlaceholder() {\n    this.grid.placeholderCell && (this.grid.placeholderCell.ariaColSpan = this.grid.grid.ariaColCount);\n  }\n  intializeFooter() {\n    var _this$grid$footerCell, _this$grid$footerCell2;\n    this.grid.footerRowGroup && this.grid.footerRow && (this.grid.footerRowGroup.role = \"rowgroup\", this.grid.footerRow.role = \"row\", this.grid.footerRow.ariaRowIndex = \"\" + (this.grid.rows.length + 2), (_this$grid$footerCell = this.grid.footerCells) !== null && _this$grid$footerCell !== void 0 && _this$grid$footerCell.forEach(o => o.role = \"gridcell\"), 1 === ((_this$grid$footerCell2 = this.grid.footerCells) === null || _this$grid$footerCell2 === void 0 ? void 0 : _this$grid$footerCell2.length) && (this.grid.footerCells[0].ariaColSpan = this.grid.grid.ariaColCount));\n  }\n  patchInvalidScreenReaderBehavior(t) {\n    if (o() || i()) {\n      var _t$textContent;\n      const o = r(t).filter(o => !o.readonly),\n        i = t.ariaLabel ? t.ariaLabel : t === null || t === void 0 || (_t$textContent = t.textContent) === null || _t$textContent === void 0 ? void 0 : _t$textContent.trim();\n      (o.length || t.resizable) && i.length && (t.ariaLabel = i, t.setAttribute(\"scope\", \"col\"));\n    }\n  }\n}\nexport { s as AriaGridController, e as ariaGrid };\n//# sourceMappingURL=aria-grid.controller.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}